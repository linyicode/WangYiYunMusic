第三版,主要是各种异常处理